<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Generator</title>
    <style>
        body { font-family: sans-serif; margin: 2em; }
        .form-group { margin-bottom: 1em; }
        label { display: block; margin-bottom: 0.5em; }
        input, select { width: 100%; padding: 0.5em; box-sizing: border-box; }
        #loading, #result { margin-top: 1em; }
        #status-container { margin-top: 2em; }
        .panel { padding: 1em; border: 1px solid #ccc; background-color: #f9f9f9; }
        .row { display: flex; gap: 1em; }
        .col { flex: 1; }
        .muted { color: #666; font-size: 0.9em; }
        .inline { display: inline-block; width: auto; }
        .half { width: 49%; display: inline-block; }
        /* Highlighted, bold Download button */
        .btn-download {
            display: inline-block;
            margin-top: 12px;
            padding: 10px 16px;
            background: #1976d2;
            color: #fff;
            font-weight: 700;
            text-decoration: none;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        .btn-download:hover { background: #1565c0; }
    </style>
</head>
<body>
    <h1>Automated Social Video Generator</h1>
    <form id="video-form" enctype="multipart/form-data">
        <div class="form-group">
            <label for="project-title">Project Title</label>
            <input type="text" id="project-title" name="project_title" required>
        </div>
        <div class="form-group" style="display:none;">
            <label for="script">Script/Text (for reference)</label>
            <textarea id="script" name="script" rows="4" style="width:100%;"></textarea>
        </div>
        <div class="form-group">
            <label for="drive_link">Google Drive Folder Link</label>
            <input type="url" id="drive_link" name="drive_link" placeholder="https://drive.google.com/drive/folders/...">
            <div class="muted">Recommended. Files from this folder will be used. Ensure sharing is set to "Anyone with the link: Viewer".</div>
        </div>
        <div class="form-group">
            <label for="audio">Audio File (.mp3) <span class="muted inline">(optional)</span></label>
            <input type="file" id="audio" name="audio" accept=".mp3">
        </div>
        <div class="form-group">
            <label for="images">Image Files (.jpg, .png, .webp) <span class="muted inline">(optional)</span></label>
            <input type="file" id="images" name="images" accept=".jpg,.jpeg,.png,.webp" multiple>
        </div>
        <div class="form-group">
            <label for="aspect_ratio">Video Ratio</label>
            <select id="aspect_ratio" name="aspect_ratio">
                <option value="9:16" selected>9:16 (Vertical)</option>
                <option value="16:9">16:9 (Horizontal)</option>
            </select>
        </div>
        <fieldset class="panel" style="margin-top:1em;">
            <legend>Caption Settings</legend>
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="font">Font Family</label>
                        <select id="font" name="font">
                            <option value="Impact" selected>Impact (stylized)</option>
                            <option value="Arial">Arial</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Verdana">Verdana</option>
                        </select>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="font-size">Font Size (H1 default)</label>
                        <input type="number" id="font-size" name="font_size" min="18" value="120">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label for="font-color">Font Color</label>
                        <input type="color" id="font-color" name="font_color" value="#FFFFFF">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="position_vertical">Vertical Position on 9:16 (distance from bottom)</label>
                <input type="range" id="position_vertical" name="position_vertical" min="10" max="100" step="10" value="80">
                <span id="position-value">80%</span>
            </div>
            <div class="row">
                <div class="col">
                    <div class="form-group">
                        <label><input class="inline" type="checkbox" id="caption_auto" name="caption_auto" checked> Auto-generate captions (AssemblyAI)</label>
                        <div class="muted" style="display:none;">Provide an SRT to override auto captions.</div>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label><input class="inline" type="checkbox" id="background_music" name="background_music" checked> Add background music</label>
                        <div class="muted">Uses Pulsar.mp3 and trims/loops to match audio duration.</div>
                        <div class="form-group" style="margin-top:8px;">
                            <label for="background_music_level">Background music level: <span id="bgm-level-value">4%</span></label>
                            <input type="range" id="background_music_level" name="background_music_level" min="4" max="12" step="2" value="4">
                            <div class="muted">Available levels: 4%, 6%, 8%, 10%, 12%</div>
                        </div>
                    </div>
                </div>
                <div class="col" style="display:none;">
                    <div class="form-group">
                        <label for="srt">Optional SRT File</label>
                        <input type="file" id="srt" name="srt" accept=".srt">
                    </div>
                </div>
            </div>
        </fieldset>
        <button type="submit" id="generate-btn">Generate Video</button>
    </form>

    <div id="loading" style="display:none;">
        <p>Generating video, this may take a few minutes...</p>
    </div>
    <div id="result"></div>

    <div id="status-container" style="display:none;">
        <div class="muted" id="elapsed-time" style="margin-bottom:8px;">Time: 00:00</div>
        <div class="panel">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                <strong>Progress</strong>
                <span id="progress-text" class="muted">0%</span>
            </div>
            <div style="background:#eee; height:12px; border-radius:6px; overflow:hidden;">
                <div id="progress-bar" style="height:12px; width:0%; background:#1976d2; border-radius:6px;"></div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>